\usemodule[basicexam][layout=twoup,mode={teacher}]
%\usemodule[basicexam][mode={teacher,check}]

\setupinteraction[state=start]
\setuptextrules[style=\tf\ss,before=,after=,rulethickness=.5pt]
\setuplayout[width=.75\paperwidth,backspace=.2\paperwidth]
\setuphead[section][style=\ss\bfb,color=black]
\setuphead[subsection][style=\ss\bf,color=blue]
\setuptyping[style=\ttxx\setuplocalinterlinespace[line=2ex],
             option={context},
             before={\vbox{\hrule height .5pt\par
                     \textrule{EXAMPLE}%
                     \hrule height .5pt\vrule width0pt depth 4pt}\par},
              after={\vbox{\hrule height .5pt\strut}},
             ]

\starttext
\dontcomplain

\placecontent

\setupquestion[answer={default answer},point=1]
\setupproblem [left=(,right=),stopper=,width=\widthofstring{(00)}]

\section{Choice}

\subsection{full example \& quick example}

\startbuffer
\startquestion
  This is the question stem of the selection question.
  \startchoice
    \startcitem Choice One   \stopcitem
    \startcitem Choice Two   \stopcitem
    \startcitem Choice Three \stopcitem
    \startcitem Choice Four  \stopcitem
  \stopchoice
\stopquestion

\question{This is the question stem of the selection question.
   \choice{Choice One,Choice Two,Choice Three,Choice Four}
}

\start
\startquestion
  This is the question stem of the selection question.
  \startchoice[8]
    \startcitem Choice One   \stopcitem
    \startcitem Choice Two   \stopcitem
    \startcitem Choice Three \stopcitem
    \startcitem Choice Four  \stopcitem
  \stopchoice
\stopquestion

\question{This is the question stem of the selection question.
   \choice[8]{Choice One,Choice Two,Choice Three,Choice Four}
}

\startplacefigure [location={none,right,2*hang}]
  \externalfigure [][height=5\baselineskip]
\stopplacefigure
\question
{\input knuthmath
\choice[one,vertical]{Choice One,Choice Two,Choice Three,Choice Four}
}
\stop
\stopbuffer

\typebuffer

\getbuffer

\subsection{example with answer}

\startbuffer
\startquestion[reference=Q,
               showanswer=true,
               showpoint=true,
               point=4,
               answer=Q]
  This is the question stem of the selection question \fillin{Answer Q}.
  \startchoice
    \startcitem    Choice One   \stopcitem
    \startcitem    Choice Two   \stopcitem
    \startcitem[*] Choice Three \stopcitem
    \startcitem    Choice Four  \stopcitem
  \stopchoice
  \startanswer
    This is a detailed explanation of this topic.
    It should be noted that the answer will be overwritten by the next answer. 
    Three answers are set for this question, but only the last answer will be selected in the end.
  \stopanswer
\stopquestion

\question[reference=QQ,
          showanswer=true,
          showpoint=true,
          point=4,
          answer=QQ]
  {This is the question stem of the selection question.\fillin{Answer QQ}.
  \choice{Choice One,Choice Two,Choice Three,{[*]Choice Four}}
  \startanswer
  This is a detailed explanation of this topic.
  It should be noted that the answer will be overwritten by the next answer. 
  Three answers are set for this question, but only the last answer will be selected in the end.
  \stopanswer
  }

\stopbuffer

\typebuffer

\getbuffer

\subsection{example with script}

\startbuffer
\startquestion[reference=Q,
               showpoint=true,
               point=4,
               answer=Q]
  This is the question stem of the selection question \fillin{Answer Q}.
  \startchoice
    \startcitem    Choice One   \stopcitem
    \startcitem    Choice Two   \stopcitem
    \startcitem[*] Choice Three \stopcitem
    \startcitem    Choice Four  \stopcitem
  \stopchoice
  \startanswer[showscript=true,showanswer=false,
               scriptcontent={\centerline{\lightgray\ss WRITE YOUR ANSWER HERE.}\par
                              \null\vskip2\baselineskip\relax}]
    This is a detailed explanation of this topic.
    It should be noted that the answer will be overwritten by the next answer. 
    Three answers are set for this question, but only the last answer will be selected in the end.
  \stopanswer
\stopquestion

\question[showpoint=true,point=4,]
  {This is the question stem of the selection question.\relax
   \choice{Choice One,Choice Two,Choice Three,Choice Four}}
\startanswer[showscript=true,frame=off,scriptcontent=\null\blank[3*line]]

\stopanswer

\question[showpoint=true,point=4,]
  {This is the question stem of the selection question.\relax
   \choice{Choice One,Choice Two,Choice Three,Choice Four}}
\stopbuffer

\typebuffer

\getbuffer

\subsection{adjust style}

\startbuffer
\startquestion[style=ss,pointlabel={total , pts},point=2,showpoint=true]
  This is the question stem of the selection question.
  \startchoice[style=tt,color=red]
    \startcitem Choice One   \stopcitem
    \startcitem Choice Two   \stopcitem
    \startcitem Choice Three \stopcitem
    \startcitem Choice Four  \stopcitem
  \stopchoice
\stopquestion

\startquestion[answerstyle=tt,answercolor=darkred,
               point=2,
               pointstyle=tt, pointcolor=darkred,
               textstyle=ss,textcolor=blue,
               showpoint=true,showanswer=true]
  This is the question stem of the selection question.
  \startchoice[answerstyle=\tt,answercolor=green,textstyle=rm,textcolor=darkred,]
    \startcitem Choice One      \stopcitem
    \startcitem Choice Two      \stopcitem
    \startcitem[*] Choice Three \stopcitem
    \startcitem Choice Four     \stopcitem
  \stopchoice
\stopquestion
\stopbuffer

\typebuffer

\getbuffer

\subsection{inline choice}

\startbuffer
\startquestion
  This is the question stem of the selection question.\relax
  \startinlinechoice
    \startcitem Choice One   \stopcitem
    \startcitem Choice Two   \stopcitem
    \startcitem Choice Three \stopcitem
    \startcitem Choice Four  \stopcitem
  \stopinlinechoice
\stopquestion

\question{This is the question stem of the selection question.\relax
   \inlinechoice{Choice One,Choice Two,Choice Three,Choice Four}
}

\startquestion[showanswer=true]
  This is the question stem of the selection question.\relax\break
  \startinlinechoice
    \startcitem[*] Choice One\stopcitem
    \startcitem Choice Two   \stopcitem
    \startcitem Choice Three \stopcitem
    \startcitem Choice Four  \stopcitem
  \stopinlinechoice
\stopquestion

\question[showanswer=true]{This is the question stem of the selection question.\relax\break\hfill
   \inlinechoice{Choice One,{[*]Choice Two},Choice Three,Choice Four}
}
\stopbuffer

\typebuffer

\getbuffer

\startbuffer
\startquestion
  This is the question stem of the selection question.\relax
  \startchoice[vertical,text][]
    \startcitem Choice One   \stopcitem
    \startcitem[*] Choice Two   \stopcitem
    \startcitem Choice Three \stopcitem
    \startcitem Choice Four  \stopcitem
  \stopchoice
\stopquestion

\question[showanswer=true]{This is the question stem of the selection question.\relax
   \choice[vertical,text][]{Choice One,{[*]Choice Two},Choice Three,Choice Four}
}

\definechoice[newinlinechoice][inlinechoice=true,correctsymbol=default]
\startquestion
  This is the question stem of the selection question.\relax
  \startnewinlinechoice
    \startcitem Choice One   \stopcitem
    \startcitem[*] Choice Two   \stopcitem
    \startcitem Choice Three \stopcitem
    \startcitem Choice Four  \stopcitem
  \stopnewinlinechoice
\stopquestion

\question[showanswer=true]{This is the question stem of the selection question.\relax
   \newinlinechoice{Choice One,{[*]Choice Two},Choice Three,Choice Four}
}
\stopbuffer

\typebuffer

\getbuffer

\subsection{multichoice}

\startbuffer
\startquestion[showanswer=true]
  This is the question stem of the selection question.\relax
  \startchoice
    \startcitem[*]   Choice One\stopcitem
    \startcitem      Choice Two\stopcitem
    \startcitem[*] Choice Three\stopcitem
    \startcitem     Choice Four\stopcitem
  \stopchoice
\stopquestion

\question[showanswer=true]{This is the question stem of the selection question.\relax
   \choice{{[*]Choice One},{[*]Choice Two},Choice Three,Choice Four}
}

\startquestion[showanswer=true]
  This is the question stem of the selection question.\relax
  \startinlinechoice
    \startcitem[*]   Choice One\stopcitem
    \startcitem      Choice Two\stopcitem
    \startcitem[*] Choice Three\stopcitem
    \startcitem     Choice Four\stopcitem
  \stopinlinechoice
\stopquestion

\question[showanswer=true]{This is the question stem of the selection question.\relax
   \inlinechoice{Choice One,{[*]Choice Two},Choice Three,{[*]Choice Four}}
}
\stopbuffer

\typebuffer

\getbuffer

\subsection{more instance}

\startbuffer
  \definechoice[choiceexample]
  \setupchoice
    [choiceexample]
    [option={text,6,packed,joinedup,nowhite,},
     inlinechoice=true,
     correctsymbol={\symbol{markcirclecheck}},
     inlineleft={!!\nobreak},
     inlineright={\nobreak !!},
     answerstyle=\ss,
     separator={\removeunwantedspaces,\space},]
     
\startquestion[showanswer=true]
  This is the question stem of the selection question.\relax
  \startchoiceexample
    \startcitem[*]   Choice One\stopcitem
    \startcitem      Choice Two\stopcitem
    \startcitem[*] Choice Three\stopcitem
    \startcitem     Choice Four\stopcitem
  \stopchoiceexample
\stopquestion
\stopbuffer

\typebuffer

\getbuffer

\subsection{point calculation}

\startbuffer
\question[point={1.5},showpoint=true]{AXXXA\choice{dummy text,XXX,YYY,ZZZ}}
\question[point={2.2},showpoint=true]{AXXXA\choice{dummy text dummy text,XXX,YYY,ZZZ}}
\question[point={1.8},showpoint=true]{AXXXA\choice{dummy text dummy text dummy text dummy text,XXX,YYY,ZZZ}}
\stopbuffer

\typebuffer

\getbuffer

\section{Question}

\subsection{question \& problem}

\startbuffer
\startquestion[start=1,option={n,packed,joinedup,nowhite},]
This is the main part of the question.
\stopquestion

\question
{This is the main part of the question.}

\startquestion
This is the main part of the question.
  \startquestion
    This is the main part of the question.
      \startquestion
        This is the main part of the question.
      \stopquestion
  \stopquestion
  \startquestion
    This is the main part of the question.
      \startquestion
        This is the main part of the question.
      \stopquestion
      \startquestion
        This is the main part of the question.
      \stopquestion
      \startquestion
        This is the main part of the question.
      \stopquestion
  \stopquestion
\stopquestion

\startquestion
This is the main part of the question.
  \startproblem
  \startpitem  This is the first small question.\stoppitem
  \startpitem This is the second small question.\stoppitem
  \stopproblem
\stopquestion

\question
{This is the main part of the question.
  \problem[textstyle=ss]
    {\pitem{This is the first small question.}
     \pitem{This is the second small question.}
  }
}
\stopbuffer

\typebuffer

\getbuffer

\subsection{True/False questions}

\startbuffer
\startquestion
This is the main part of the question.
  \startproblem
  \startpitem  \fillin{} This is the first  small question.\stoppitem
  \startpitem  \fillin{} This is the second small question.\stoppitem
  \stopproblem
\stopquestion

\start
\setupfillin[empty=none,style=\tta]
\startquestion
This is the main part of the question.
  \startproblem
  \startpitem  \fillin{T} This is the first  small question.\stoppitem
  \startpitem  \fillin{F} This is the second small question.\stoppitem
  \startpitem  This is the first  small question.\hfill\fillin{\symbol{markcheck}}\stoppitem
  \startpitem  This is the second small question.\hfill\fillin{\symbol{markcross}}\stoppitem
  \stopproblem
\stopquestion
\stop
\stopbuffer

\typebuffer

\getbuffer

\subsection{example with answer}

\startbuffer
\setupquestion[showanswer=true,showpoint=true,point=1]
\setupanswer  [showanswer=true,showpoint=true]
\startquestion[start=1,option={n,packed,joinedup,nowhite},answer=aaa]
This is the main part of the question.
\startanswer This is a detailed explanation of this topic.\stopanswer
\stopquestion

\question[answer=bbb]
{This is the main part of the question.}
\startanswer This is a detailed explanation of this topic.\stopanswer

\startquestion
This is the main part of the question.
  \startproblem
  \startpitem[answer=eee]
    This is the first small question.
    \startanswer This is a detailed explanation of this topic.\stopanswer
  \stoppitem
  \startpitem[answer=fff]
    This is the second small question.
    \startanswer This is a detailed explanation of this topic.\stopanswer
  \stoppitem
  \stopproblem
\stopquestion

\question
{This is the main part of the question.
  \problem[textstyle=ss]
    {\pitem[answer=ggg]{This is the first small question.}
     \startanswer This is a detailed explanation of this topic.\stopanswer
     \pitem[answer=hhh]{This is the second small question.}
     \startanswer This is a detailed explanation of this topic.\stopanswer
     \pitem[answer=iii]{This is the second small question.}
     \startanswer This is a detailed explanation of this topic.\stopanswer
  }
}
\stopbuffer

\typebuffer

\start\getbuffer\stop

\setupanswer
  [scriptcontent={
    \centerline{\lightgray
    \ss WRITE YOUR ANSWER HERE.}\par
    \null\vskip2\baselineskip\relax}]

\startbuffer
\startpitem[answer={ccc,will be replace}]
   Lorem ipsum dolor sit amet,
   \fillin{Lorem ipsum,the real answer}
\stoppitem
\startanswer
 Here is answer.
\stopanswer
\stopbuffer

\subsection{fillin }

\start
\setupquestion[answer=cxxx,showanswer=false,point=2,showpoint=false]

\startquestion[showanswer=false]
  Lorem ipsum dolor sit amet,
  \startproblem
    {\setupfillin[empty=number, n=5]\getbuffer}
    {\setupfillin[empty=number, n=*]\getbuffer}
    {\setupfillin[empty=number, align=autoright,n=5]\getbuffer}
    {\setupfillin[empty=number, align=autoright,n=*]\getbuffer}
    
    {\setupfillin[empty=yes,    n=5]\getbuffer}
    {\setupfillin[empty=yes,    n=*]\getbuffer}
    {\setupfillin[empty=yes,    align=autoright,n=5]\getbuffer}
    {\setupfillin[empty=yes,    align=autoright,n=*]\getbuffer}
    
    {\setupfillin[empty=none,   n=5]\getbuffer}
    {\setupfillin[empty=none,   n=*]\getbuffer}
    {\setupfillin[empty=none,   align=autoright,n=5]\getbuffer}
    {\setupfillin[empty=none,   align=autoright,n=*]\getbuffer}
  \stopproblem
\stopquestion

\setupquestion[answer=cxxx,showanswer=true,point=2,showpoint=true]

\startquestion[showanswer=true]
  Lorem ipsum dolor sit amet,
  \startproblem
    \startpitem[answer={ccc,will be replace},point=5]
               Lorem ipsum dolor sit amet,
               \fillin{Lorem ipsum,the real answer 1}
               \fillin{Lorem ipsum,the real answer 2}\stoppitem
    {\setupfillin[empty=number, n=5]\getbuffer}
    {\setupfillin[empty=yes,    n=5]\getbuffer}
    {\setupfillin[empty=none,   n=5]\getbuffer}
    {\setupfillin[empty=number, n=*]\getbuffer} 
    {\setupfillin[empty=yes,    n=*]\getbuffer}
    {\setupfillin[empty=none,   n=*]\getbuffer}
    {\setupfillin[empty=number, align=autoright,n=5]\getbuffer}
    {\setupfillin[empty=yes,    align=autoright,n=5]\getbuffer}
    {\setupfillin[empty=none,   align=autoright,n=5]\getbuffer}
    {\setupfillin[empty=number, align=autoright,n=*]\getbuffer}
    {\setupfillin[empty=yes,    align=autoright,n=*]\getbuffer}
    {\setupfillin[empty=none,   align=autoright,n=*]\getbuffer}
  \stopproblem
\stopquestion
\stop

\section{Material}

\startbuffer
\setupmaterial[title] [style=\ssa]
\setupmaterial[author][style=\tta]
\setupmaterial[source][style=ss]
\setupmaterial[number][numberconversion=I]
\setupmaterial[indicator][numberconversion=A,reset=true]

\startmaterial[title={Knuth 1},author={Mos},source={Yelu}]
  \input knuth\relax
  \indicator{Some Texts 1}
  \indicator{Some Texts 2} 
\stopmaterial

\startquestion[start=1,option={n,packed,joinedup,nowhite}]
  \indicator{Some Texts 1}
  \choice{Some Texts,Some Texts,Some Texts,Some Texts}
\stopquestion
\startquestion
  \indicator{Some Texts 2}
  \choice{Some Texts,Some Texts,Some Texts,Some Texts}
\stopquestion

\startmaterial[title={Knuth 2},author={Mos},source={Yelu}]
\input knuth\relax\indicator{Some Texts 3} \indicator{Some Texts 4}
\stopmaterial
\startquestion
  \indicator{Some Texts 3}
  \choice{Some Texts,Some Texts,Some Texts,Some Texts}
\stopquestion
\startquestion
  \indicator{Some Texts 4}
  \choice{Some Texts,Some Texts,Some Texts,Some Texts}
\stopquestion
\stopbuffer

\typebuffer
\getbuffer

\section{Close}

\startclose[showanswer=true,showpoint=true,point=5,answer=nil]
On Oct. 11, hundreds of runners competed in a cross-country race in Minnesota.
Melanie Bailey should have \closechoice[designed,followed,changed,finished] the
course earlier than she did. Her \closechoice[delay,chance,trouble,excuse] came
because she was carrying a \closechoice[judge,volunteer,classmate,competitor]
across the finish line.

As reported by a local newspaper, Bailey was more than two-thirds of the way
through her \closechoice[race,school,town,training] when a runner in front of
her began crying in pain. She \closechoice[agreed,returned,stopped,promised]
to help her fellow runner, Danielle Lenoue. Bailey took her arm to see if she
could walk forward with \closechoice[courage,aid,patience,advice] . She couldn't.
Bailey then \closechoice[went away,stood up,stepped aside,bent down] to let Lenoue
climb onto her back and carried her all the way to the finish line, then another
300 feet to where Lenoue could get \closechoice[medical,public,constant,equal] attention.

Once there, Lenoue was \closechoice[interrupted,assessed,identified,appreciated]
and later taken to a hospital, where she learned that she had serious injuries in
one of her knees. She would have struggled with extreme \closechoice[hunger,pain,cold,tiredness]
to make it to that aid checkpoint without Bailey's help.

As for Bailey, she is more \closechoice[worried,ashamed,confused,discouraged]
about why her act is considered a big \closechoice[game,problem,lesson,deal] .
"She was just crying. I couldn't \closechoice[leave,cure,bother,understand] her,"
Bailey told the reporter. "I feel like I was just doing the right thing.”

Although the two young women were strangers before the \closechoice[ride,test,meet,show] ,
they've since become friends. Neither won the race, but the \closechoice[secret,display,benefit,exchange]
of human kindness won the day.
\stopclose

\section{answer box}

\startbuffer
\dorecurse{5}{\typeanswerbychap{0},}

\newcount\tempa\tempa=2\relax
\dorecurse{5}{\typeanswerbychap[\tempa]{0},\advance\tempa by 1\relax}

\typeanswerdirect{0-5}
\stopbuffer

\typebuffer
\getbuffer

\startbuffer
\typeanswerlist{5}
     
\typeanswerlist[0]{5}   
 
\typeanswerlist[0][2]{5}
\stopbuffer

\typebuffer
\getbuffer

\startbuffer
\typeanswertable[2,5]          \null\par
\typeanswertable[2,5][0]       \null\par
\typeanswertable[2,5][0][6]    \null\par

\typeanswertablealt[2,5]       \null\par
\typeanswertablealt[2,5][0]    \null\par
\typeanswertablealt[2,5][0][6] \null\par
\stopbuffer

\typebuffer
\getbuffer

\section{Score}

\startbuffer
\startanswer[showanswer=true]
 some text \score{2}
 some text \score{4}
 \resetscore
 \setupscore[score=calculation]
 some text \score[type=cdotfill]{2}
 some text \score[type=space]{4}
 some text \score[type=hfill]{3}
 \resetscore
 \setupscore[score=complex]
 some text \score{2}
 some text \score{4}
 some text \score{3}
\stopanswer
\stopbuffer

\typebuffer

\getbuffer

\chapter{More Test}

\question[I][answer=1,showanswer=true,showpoint=true]
  {one nest\answer{explain}}\answer{explain}

\question[I][answer=1,showanswer=true,showpoint=true]{one nest
  \question[A][answer=2]{two nest
    \question[I][answer=3]{three nest\answer{explain in question}}\answer{explain out question}
    \question[I][answer=4]{three nest\answer{explain in question}}\answer{explain out question}
    \question[I][answer=5]{three nest\answer{explain in question}}\answer{explain out question}
  }
  \question[n][answer=2]{two nest
    \question[I][answer=6]{three nest\answer{explain in question}}\answer{explain out question}
    \question[I][answer=7]{three nest\answer{explain in question}}\answer{explain out question}
    \question[I][answer=8]{three nest\answer{explain in question}}\answer{explain out question}
  }
}

\question[showanswer=true,showpoint=true]{new test
  \problem{
    \pitem[answer=A]{new test 1\answer{explain}}\answer{explain}
    \pitem[answer=B]{new test 2\answer{explain}}\answer{explain}
    \pitem[answer=C]{new test 3\answer{explain}}\answer{explain}
  }
}


\question[point=1,showpoint=true,answer=9]
{It should be reset back to 1 here.\choice{XXX,YYY,ZZZ}}
\startanswer[showanswer=true,showpoint=true]
   some text
\stopanswer

\startquestion[point={1.5},showanswer=true,showpoint=true]
  \startproblem
    \dorecurse{5}{\pitem[answer=123] {some texts}}
  \stopproblem
\stopquestion

\setupwriting[showanswer=true,showpoint=true,answer=xxx]
\setupsubwriting[answer=xxnx]
\startwriting[point=45]
  Explanation of the topic of the composition
  \startanswer
  Reference composition 1
  \stopanswer
\stopwriting
\startwriting
  Explanation of the topic of the composition
  \startsubwriting[point=450]
    Sub Composition Topic Description
    \startanswer
    Reference composition 2
    \stopanswer
  \stopsubwriting
  \startsubwriting[point=4588]
    Sub Composition Topic Description
    \startanswer
    Reference composition 3
    \stopanswer
  \stopsubwriting
\stopwriting


\stoptext